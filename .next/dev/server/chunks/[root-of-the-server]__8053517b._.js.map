{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/forum2/pages/api/forum/new.js"],"sourcesContent":["import mysql from \"mysql2/promise\";\r\n\r\nexport default async function handler(req, res) {\r\n  if (req.method !== \"POST\") {\r\n    return res.status(405).json({ message: \"Метод не разрешён\" });\r\n  }\r\n\r\n  const { title, content, authorId } = req.body;\r\n\r\n  if (!title || !content || !authorId) {\r\n    return res.status(400).json({ message: \"Заполните все поля\" });\r\n  }\r\n\r\n  try {\r\n    const db = await mysql.createConnection({\r\n      host: process.env.TIDB_HOST,\r\n      user: process.env.TIDB_USER,\r\n      password: process.env.TIDB_PASSWORD,\r\n      database: \"test\",\r\n      ssl: { rejectUnauthorized: true }\r\n    });\r\n\r\n    const [result] = await db.execute(\r\n      \"INSERT INTO threads (title, content, author_id) VALUES (?, ?, ?)\",\r\n      [title, content, authorId]\r\n    );\r\n\r\n    await db.end();\r\n\r\n    return res.status(200).json({\r\n      success: true,\r\n      threadId: result.insertId\r\n    });\r\n\r\n  } catch (err) {\r\n    console.log(err);\r\n    return res.status(500).json({ message: \"Ошибка сервера\" });\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,IAAI,IAAI,MAAM,KAAK,QAAQ;QACzB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;QAAoB;IAC7D;IAEA,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,IAAI,IAAI;IAE7C,IAAI,CAAC,SAAS,CAAC,WAAW,CAAC,UAAU;QACnC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;QAAqB;IAC9D;IAEA,IAAI;QACF,MAAM,KAAK,MAAM,sIAAK,CAAC,gBAAgB,CAAC;YACtC,MAAM,QAAQ,GAAG,CAAC,SAAS;YAC3B,MAAM,QAAQ,GAAG,CAAC,SAAS;YAC3B,UAAU,QAAQ,GAAG,CAAC,aAAa;YACnC,UAAU;YACV,KAAK;gBAAE,oBAAoB;YAAK;QAClC;QAEA,MAAM,CAAC,OAAO,GAAG,MAAM,GAAG,OAAO,CAC/B,oEACA;YAAC;YAAO;YAAS;SAAS;QAG5B,MAAM,GAAG,GAAG;QAEZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAC1B,SAAS;YACT,UAAU,OAAO,QAAQ;QAC3B;IAEF,EAAE,OAAO,KAAK;QACZ,QAAQ,GAAG,CAAC;QACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,SAAS;QAAiB;IAC1D;AACF"}}]
}